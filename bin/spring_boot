#!/usr/bin/env bash

set -euo pipefail

APP_NAME=$1
APP_ZIP_FILENAME="${APP_NAME}.zip"
LANGUAGE="java"
JAVA_VERSION="11"
TYPE="gradle-project"
DEPENDENCIES="web,actuator"
GROUP_ID="io.github.mamachanko"
# INITIALIZR_HOSTNAME="https://start.spring.io"
INITIALIZR_HOSTNAME="http://localhost:8080"

curl \
    --fail \
    --request GET \
    --url "$INITIALIZR_HOSTNAME/starter.zip?dependencies=$DEPENDENCIES&language=$LANGUAGE&javaVersion=$JAVA_VERSION&type=$TYPE&groupId=$GROUP_ID&name=$APP_NAME" \
    --output "$APP_ZIP_FILENAME"

unzip "$APP_ZIP_FILENAME" -d "$APP_NAME"

rm "$APP_ZIP_FILENAME"
